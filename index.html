<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MIQAT</title>

<style>
:root{
  --bg:#020617;
  --card:#0f172a;
  --accent:#22d3ee;
  --text:#e5e7eb;
  --muted:#9ca3af;
}
*{box-sizing:border-box}
body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:radial-gradient(circle at top,#1e293b,#020617);
  font-family:system-ui;
  color:var(--text);
}
.container{
  width:100%;
  max-width:520px;
  padding:22px;
  background:#020617;
  border-radius:22px;
  box-shadow:0 0 40px rgba(34,211,238,.18);
}
h1{text-align:center;margin-bottom:10px}
.timer{font-size:48px;text-align:center;margin:10px 0}

/* INPUT JAM & MENIT (RAPI HP) */
.time-input-group{
  display:flex;
  justify-content:center;
  align-items:flex-end;
  gap:8px;
  margin:14px 0;
}
.time-field{
  display:flex;
  flex-direction:column;
  align-items:center;
}
.time-field label{
  font-size:11px;
  color:var(--muted);
  margin-bottom:4px;
}
.time-field input{
  width:72px;
  padding:8px;
  text-align:center;
  border-radius:10px;
  border:1px solid #1f2937;
  background:#020617;
  color:var(--text);
}
.time-separator{
  font-size:20px;
  color:var(--muted);
  padding-bottom:6px;
}

.progress-wrapper{
  height:8px;
  border-radius:999px;
  background:#020617;
  border:1px solid #1f2937;
  overflow:hidden;
}
.progress-bar{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#38bdf8,#0ea5e9);
  transition:width .4s ease;
}

.buttons{
  display:flex;
  gap:10px;
  margin-top:12px;
}
button{
  flex:1;
  padding:12px;
  border:none;
  border-radius:14px;
  font-weight:600;
}
.start{background:#22d3ee;color:#020617}
.pause{background:#1f2937;color:#fff}
.reset{background:#7c2d12;color:#fff}

.todo{margin-top:18px}
.task-progress-text{
  font-size:12px;
  color:var(--muted);
  text-align:right;
  margin-top:4px;
}
.todo-input{
  display:flex;
  gap:8px;
  margin-top:10px;
}
.todo-input input{
  flex:1;
  padding:10px;
  border-radius:12px;
  border:1px solid #1f2937;
  background:#020617;
  color:var(--text);
}
.todo-input button{
  background:var(--accent);
  color:#020617;
  border:none;
  border-radius:12px;
  width:48px;
}

ul{list-style:none;padding:0;margin-top:12px}
li{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:12px;
  border-radius:14px;
  border:1px solid #1f2937;
  margin-bottom:8px;
}
.task-left{
  display:flex;
  align-items:center;
  gap:10px;
}
.task-time{
  font-size:12px;
  color:var(--muted);
}
.done .task-name{
  text-decoration:line-through;
  color:#22c55e;
}

.copyright{
  position:fixed;
  bottom:6px;
  left:50%;
  transform:translateX(-50%);
  font-size:10px;
  color:rgba(255,255,255,.35);
}
</style>
</head>

<body>
<div class="container">
  <h1>⏱ MIQAT</h1>
  <div class="timer" id="timer">00:00:00</div>

  <div class="progress-wrapper">
    <div class="progress-bar" id="progressBar"></div>
  </div>

  <div class="time-input-group">
    <div class="time-field">
      <label>Jam</label>
      <input id="hour" type="number" min="0" placeholder="0">
    </div>
    <span class="time-separator">:</span>
    <div class="time-field">
      <label>Menit</label>
      <input id="minute" type="number" min="0" max="59" placeholder="00">
    </div>
  </div>

  <div class="buttons">
    <button class="start" onclick="startTimer()">Mulai</button>
    <button class="pause" onclick="togglePause()">Jeda</button>
    <button class="reset" onclick="resetTimer()">Reset</button>
  </div>

  <div class="todo">
    <div class="task-progress-text" id="taskProgressText">0% tugas selesai</div>

    <div class="todo-input">
      <input id="taskInput" placeholder="Tambah tugas...">
      <button onclick="addTask()">+</button>
    </div>

    <ul id="taskList"></ul>
  </div>
</div>

<div class="copyright">© 2025 Afhimna Dev. All Rights Reserved.</div>

<script>
let totalSeconds=0, initialSeconds=0, lastCheckpoint=0;
let interval=null, paused=false;

const timerEl=document.getElementById("timer");
const progressBar=document.getElementById("progressBar");
const taskProgressText=document.getElementById("taskProgressText");

function updateDisplay(){
  const h=Math.floor(totalSeconds/3600);
  const m=Math.floor((totalSeconds%3600)/60);
  const s=totalSeconds%60;
  timerEl.textContent=
    String(h).padStart(2,"0")+":"+
    String(m).padStart(2,"0")+":"+
    String(s).padStart(2,"0");
}

function startTimer(){
  if(interval) return;
  if(totalSeconds===0){
    totalSeconds=(+hour.value||0)*3600+(+minute.value||0)*60;
    initialSeconds=totalSeconds;
    lastCheckpoint=totalSeconds;
  }
  interval=setInterval(()=>{
    if(!paused && totalSeconds>0){
      totalSeconds--;
      updateDisplay();
      progressBar.style.width=((initialSeconds-totalSeconds)/initialSeconds*100)+"%";
    }
  },1000);
}

function togglePause(){paused=!paused}

function resetTimer(){
  clearInterval(interval);
  interval=null;
  paused=false;
  totalSeconds=initialSeconds=lastCheckpoint=0;
  progressBar.style.width="0%";
  updateDisplay();
}

function format(sec){
  const m=Math.floor(sec/60);
  const s=sec%60;
  return String(m).padStart(2,"0")+":"+String(s).padStart(2,"0");
}

function addTask(){
  const text=taskInput.value.trim();
  if(!text) return;

  const li=document.createElement("li");
  const left=document.createElement("div");
  left.className="task-left";

  const cb=document.createElement("input");
  cb.type="checkbox";

  const name=document.createElement("span");
  name.className="task-name";
  name.textContent=text;

  const time=document.createElement("span");
  time.className="task-time";
  time.textContent="--:--";

  cb.onchange=()=>{
    if(cb.checked){
      li.classList.add("done");
      const duration = lastCheckpoint - totalSeconds;
      lastCheckpoint = totalSeconds;
      time.textContent = format(duration);
      updateTaskProgress();
    }else{
      li.classList.remove("done");
      time.textContent="--:--";
      updateTaskProgress();
    }
  };

  left.append(cb,name);
  li.append(left,time);
  taskList.appendChild(li);
  taskInput.value="";
  updateTaskProgress();
}

function updateTaskProgress(){
  const tasks=[...document.querySelectorAll("#taskList li")];
  const done=tasks.filter(t=>t.classList.contains("done")).length;
  const percent=tasks.length?Math.round(done/tasks.length*100):0;
  taskProgressText.textContent=percent+"% tugas selesai";
}

document.addEventListener("keydown",e=>{
  if(e.code==="Space"){e.preventDefault();togglePause();}
  if(e.key==="Enter"){
    document.activeElement===taskInput?addTask():startTimer();
  }
});

updateDisplay();
</script>
</body>
</html>
