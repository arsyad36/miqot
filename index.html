<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‚è±Ô∏è MIQAT - Management Intelligent Quality Action Timer</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Inter:wght@400;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#020617;
  --border:#1f2937;
  --accent:#22d3ee;
  --success:#22c55e;
  --danger:#ef4444;
  --text:#e5e7eb;
  --muted:#9ca3af;
}

*{box-sizing:border-box}

body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:radial-gradient(circle at top,#1e293b,#020617);
  font-family:'Inter',sans-serif;
  color:var(--text);
}

.container{
  width:100%;
  max-width:520px;
  padding:20px;
  background:#020617;
  border-radius:20px;
  box-shadow:0 0 36px rgba(34,211,238,.18);
}

h1{
  font-family:'Playfair Display',serif;
  text-align:center;
  margin:0 0 8px;
  font-size:22px;
}

.timer{
  text-align:center;
  font-size:46px;
  letter-spacing:2px;
  margin-bottom:6px;
}

.progress-wrapper{
  width:100%;
  height:9px;
  background:#020617;
  border:1px solid var(--border);
  border-radius:999px;
  overflow:hidden;
  margin:10px 0;
}

.progress-bar{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#38bdf8,#0ea5e9);
  transition:width .35s ease;
}

.inputs{
  display:flex;
  gap:8px;
}

.inputs input{
  flex:1;
  padding:10px;
  border-radius:12px;
  border:1px solid var(--border);
  background:#020617;
  color:var(--text);
  font-size:14px;
  text-align:center;
}

.buttons{
  display:flex;
  gap:8px;
  margin-top:10px;
}

button{
  flex:1;
  padding:12px;
  border-radius:14px;
  border:none;
  font-weight:600;
  cursor:pointer;
  font-size:14px;
}

.start{background:linear-gradient(135deg,#22d3ee,#38bdf8);color:#020617;}
.pause{background:#1f2937;color:#fff;}
.reset{background:#7c2d12;color:#fff;}

.stop-alarm{
  display:none;
  margin-top:12px;
  width:100%;
  background:var(--danger);
  color:#fff;
}

.todo{
  margin-top:18px;
}

.todo h2{
  font-size:13px;
  color:var(--muted);
  margin-bottom:6px;
}

.task-progress-wrapper{
  width:100%;
  height:7px;
  background:#020617;
  border:1px solid var(--border);
  border-radius:999px;
  overflow:hidden;
}

.task-progress-bar{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#38bdf8,#0ea5e9);
  transition:width .3s ease;
}

.task-progress-text{
  font-size:11px;
  color:var(--muted);
  text-align:right;
  margin-top:2px;
}

.todo-input{
  display:flex;
  gap:8px;
  margin-top:8px;
}

.todo-input input{
  flex:1;
  padding:10px;
  border-radius:12px;
  border:1px solid var(--border);
  background:#020617;
  color:var(--text);
  font-size:14px;
}

.todo-input button{
  background:var(--accent);
  color:#020617;
}

ul{
  list-style:none;
  padding:0;
  margin-top:10px;
}

li{
  display:flex;
  align-items:center;
  gap:8px;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid var(--border);
  margin-bottom:8px;
}

.task-check{
  width:18px;
  height:18px;
  accent-color:var(--accent);
}

.task-name{flex:1;}

.task-time{
  min-width:64px;
  font-size:12px;
  color:var(--muted);
  text-align:right;
}

li.done .task-name{
  text-decoration:line-through;
  color:var(--success);
  opacity:.75;
}

.copyright{
  position:fixed;
  bottom:4px;
  left:50%;
  transform:translateX(-50%);
  font-size:9px;
  color:rgba(255,255,255,.35);
  pointer-events:none;
}
</style>
</head>

<body>

<div class="container">
<h1>‚è±Ô∏è MIQAT</h1>
<div class="timer" id="timer">00:00:00</div>

<div class="progress-wrapper">
  <div class="progress-bar" id="progressBar"></div>
</div>

<div class="inputs">
  <input type="number" id="hour" placeholder="Jam">
  <input type="number" id="minute" placeholder="Menit">
</div>

<div class="buttons">
  <button class="start" onclick="startTimer()">Mulai</button>
  <button class="pause" onclick="togglePause()">Jeda</button>
  <button class="reset" onclick="resetTimer()">Reset</button>
</div>

<button class="stop-alarm" id="stopAlarmBtn" onclick="stopAlarm()">üîá STOP ALARM</button>

<div class="todo">
<h2>üìù Daftar Tugas</h2>

<div class="task-progress-wrapper">
  <div class="task-progress-bar" id="taskProgressBar"></div>
</div>
<div class="task-progress-text" id="taskProgressText">0% tugas selesai</div>

<div class="todo-input">
  <input id="taskInput" placeholder="Tambah tugas...">
  <button onclick="addTask()">Ôºã</button>
</div>

<ul id="taskList"></ul>
</div>
</div>

<p class="copyright">¬© 2025 Afhimna Dev. All Rights Reserved.</p>

<audio id="alarmSound" loop>
<source src="https://assets.mixkit.co/sfx/preview/mixkit-alarm-digital-clock-beep-989.mp3">
</audio>

<script>
let totalSeconds=0, initialSeconds=0, interval=null;
let lastTaskCheckpoint=null;

const timer=document.getElementById("timer");
const progressBar=document.getElementById("progressBar");
const alarm=document.getElementById("alarmSound");
const stopBtn=document.getElementById("stopAlarmBtn");
const taskProgressBar=document.getElementById("taskProgressBar");
const taskProgressText=document.getElementById("taskProgressText");

function formatElapsed(sec){
  const m=Math.floor(sec/60);
  const s=sec%60;
  return String(m).padStart(2,"0")+":"+String(s).padStart(2,"0");
}

function updateDisplay(){
  const h=Math.floor(totalSeconds/3600);
  const m=Math.floor((totalSeconds%3600)/60);
  const s=totalSeconds%60;
  timer.textContent=
    String(h).padStart(2,"0")+":"+
    String(m).padStart(2,"0")+":"+
    String(s).padStart(2,"0");
}

function startTimer(){
  if(interval) return;
  if(totalSeconds===0){
    totalSeconds=(hour.value||0)*3600+(minute.value||0)*60;
    initialSeconds=totalSeconds;
    lastTaskCheckpoint=null;
  }
  if(totalSeconds<=0) return;

  interval=setInterval(()=>{
    totalSeconds--;
    updateDisplay();
    progressBar.style.width=((initialSeconds-totalSeconds)/initialSeconds*100)+"%";
    if(totalSeconds<=0){
      clearInterval(interval);
      interval=null;
      alarm.play();
      stopBtn.style.display="block";
    }
  },1000);
}

function togglePause(){
  if(interval){
    clearInterval(interval);
    interval=null;
  }else{
    startTimer();
  }
}

function resetTimer(){
  clearInterval(interval);
  interval=null;
  stopAlarm();
  totalSeconds=initialSeconds=0;
  lastTaskCheckpoint=null;
  progressBar.style.width="0%";
  updateDisplay();
}

function stopAlarm(){
  alarm.pause();
  alarm.currentTime=0;
  stopBtn.style.display="none";
}

function updateTaskProgress(){
  const tasks=[...document.querySelectorAll("#taskList li")];
  const done=tasks.filter(li=>li.classList.contains("done"));
  const percent=tasks.length?Math.round(done.length/tasks.length*100):0;
  taskProgressBar.style.width=percent+"%";
  taskProgressText.textContent=percent+"% tugas selesai";
}

function addTask(){
  const text=taskInput.value.trim();
  if(!text) return;

  const li=document.createElement("li");
  const cb=document.createElement("input");
  cb.type="checkbox";
  cb.className="task-check";

  const name=document.createElement("span");
  name.className="task-name";
  name.textContent=text;

  const time=document.createElement("span");
  time.className="task-time";
  time.textContent="--:--";

  cb.onchange=()=>{
    li.classList.toggle("done");
    if(cb.checked){
      const elapsed=initialSeconds-totalSeconds;
      const duration=lastTaskCheckpoint===null
        ? elapsed
        : elapsed-lastTaskCheckpoint;
      li.dataset.time=duration;
      time.textContent=formatElapsed(duration);
      lastTaskCheckpoint=elapsed;
    }else{
      delete li.dataset.time;
      time.textContent="--:--";
    }
    updateTaskProgress();
  };

  li.append(cb,name,time);
  taskList.appendChild(li);
  taskInput.value="";
}

hour.addEventListener("keydown",e=>{if(e.key==="Enter") startTimer();});
minute.addEventListener("keydown",e=>{if(e.key==="Enter") startTimer();});
taskInput.addEventListener("keydown",e=>{
  if(e.key==="Enter"){
    e.preventDefault();
    addTask();
  }
});

document.addEventListener("keydown",e=>{
  if(e.code==="Space"){
    const tag=document.activeElement.tagName;
    if(tag!=="INPUT" && tag!=="TEXTAREA"){
      e.preventDefault();
      togglePause();
    }
  }
});
</script>

</body>
</html>
